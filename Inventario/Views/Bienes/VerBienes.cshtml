@using Inventario.Models
@using Inventario.ViewModels
@model Inventario.ViewModels.VerBienesViewModel
@{
    ViewBag.Title = "Ver Bienes";
    Layout = "~/Views/Shared/LayoutPage.cshtml";
}

<h2 class="text-center titulo">Ver Bienes</h2>

<div class="container-fluid ">
    @*Cabecera de la pagina, aqui va la barra de filtrado y la barra de buscada mas los botones*@
    
    <p class="d-none text-danger align-self-start" id="Validar">*Formato Invalido</p>
    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
    <div class="form-row">
        @*Barra de busqueda*@
        <div class="col form-group">
            @using (Html.BeginForm("BuscarVerBienes", "Bienes", FormMethod.Post, new { @class = "form-inline" }))
            { 
                        @Html.AntiForgeryToken()   
                        <label class="mr-1">Buscar Bien:</label>
                        @Html.EditorFor(m => m.numeroDePatrimonio, new { htmlAttributes = new {@class="form-control mr-1" ,maxlength = 10 } })
                        <input type="submit" class="btn btn-outline-secondary" id="buscar" value="buscar" class="" />
            }
        </div>
        @*Menu de filtrado*@
        <div class="col-sm-6 border-left border-right" >
            @*Contenido de la barra de filtrado*@
            @using (Html.BeginForm("Filtrado", "Bienes", FormMethod.Post, new { @class = "form-inline" }))
            {
                @Html.AntiForgeryToken()
                <label class="mr-1" >Estado</label>
                    @Html.DropDownListFor(model => model.estado, new SelectList(Enum.GetValues(typeof(EstadosVMEnum))) )
                    <label class="offset-1 mr-1">Especialidad</label>
                    @Html.DropDownListFor(model => model.IDEspecialidad, new SelectList(Model.especialidades, "ID", "nombreEspecialidad"), "No Filtrar")
                    <div class="offset-1">
                       
                        <div class="dropdown">
                            <button class="dropdown-toggle btn" type="button" data-toggle="dropdown">Condicion</button>
                            <div class="dropdown-menu">
                                <label class="dropdown-item">Activo @Html.RadioButton("condicion", CondicionesEnum.Activo, true)</label>
                                <label class="dropdown-item">De Baja @Html.RadioButton("condicion", CondicionesEnum.DeBaja) </label>
                            </div>
                        </div>     
                    </div>       
                    <input type="submit" class="btn btn-outline-secondary offset-1" value="Aplicar"/>     
            }
        </div>
            <div class="col-sm-2">
                @using (Html.BeginForm("RestablecerLista", "Bienes", FormMethod.Post, new { @class = "form-inline" }))
                {
                   
                        <input type="submit" value="Reestablecer" class="btn btn-outline-secondary" />
                    
                }
            </div>
    </div>

    <hr />
    @*Aqui va la tabla con los bienes*@
    <div class="row">
        <div class="col-12">
            <table class="table table-striped table-responsive-sm">
                <thead class="table-secondary border-bottom">
                    <tr>
                        <td>Número de patrimonio</td>
                        <td>Código de Barras</td>
                        <td>Descripción</td>
                        <td>Marca</td>
                        <td>Modelo</td>
                        <td>Serie</td>
                        <td>Ley que financia</td>
                        <td>Ubicacion</td>
                        <td>Especialidad</td>
                        <td>Estado</td>
                        <td>Condicion</td>
                        <td>Número de factura</td>
                        <td>Añadido por</td>
                    </tr>
                </thead>
                <tbody>
                    @if (Model.bienes == null)
                    {
                        <tr><td align="center" colspan="10">No se han encontrado objetos</td></tr>
                    }
                    else
                    {
                        foreach (Bienes bien in Model.bienes)
                        {
                            <tr>
                                <td>@Html.DisplayFor(modelItem => bien.numeroDePatrimonio)</td>
                                <td>@Html.DisplayFor(modelItem => bien.codigoDeBarras)</td>
                                <td>@Html.DisplayFor(modelItem => bien.descripcion)</td>
                                <td>@Html.DisplayFor(modelItem => bien.marca)</td>
                                <td>@Html.DisplayFor(modelItem => bien.modelo)</td>
                                <td>@Html.DisplayFor(modelItem => bien.serie)</td>
                                <td>@Html.DisplayFor(modelItem => bien.ley)</td>
                                <td>@Html.DisplayFor(modelItem => bien.ubicacion)</td>
                                <td>@Html.DisplayFor(modelItem => bien.Especialidad.nombreEspecialidad)</td>
                                <td>@Html.DisplayFor(modelItem => bien.estado)</td>
                                <td>@Html.DisplayFor(modelItem => bien.condicion)</td>
                                <td>@Html.ActionLink(bien.numeroDeFactura, "Details","Facturas", new { id = bien.numeroDeFactura }, new { target = "_blank" })</td>
                                <td>@Html.DisplayFor(modelItem => bien.anadidoPor)</td>
                            </tr>
                        }
                    }
                </tbody>
            </table>
        </div>
    </div>
<script src="~/Scripts/validar.js"></script>
</div>
